{% extends "books/base.html" %}

{% block title %}Batch Upload Results{% endblock %}

{% block content %}
<div class="results-container">
    <header class="site-header results-header">
        <div class="results-header-row">
            <h1 class="site-title">Batch Upload Results</h1>
            <a href="{% url 'books:book-list' %}" class="home-link">Home</a>
        </div>
    </header>

    <div class="summary-card card">
        <div class="summary-item">
            <div class="summary-number">{{ total }}</div>
            <div class="summary-label">Total Files</div>
        </div>
        <div class="summary-item">
            <div class="summary-number">{{ completed_count }}</div>
            <div class="summary-label">Created</div>
        </div>
        <div class="summary-item">
            <div class="summary-number {% if failed_count > 0 %}failed{% endif %}">
                {{ failed_count }}
            </div>
            <div class="summary-label">Failed</div>
        </div>
    </div>

    {% if completed_books %}
    <div class="results-section">
        <h2 class="section-title">
            ‚úì Successfully Created Books ({{ completed_count }})
        </h2>
        <div class="books-grid">
            {% for item in completed_books %}
            <div class="book-card">
                {% if item.book.cover_image %}
                <img
                    src="{{ item.book.cover_image.url }}"
                    alt="{{ item.book.title }}"
                    class="book-card-cover"
                />
                {% else %}
                <div class="book-card-cover-placeholder">üìö</div>
                {% endif %}
                <div class="book-info">
                    <div class="book-card-title">{{ item.book.title }}</div>
                    <div class="book-author">by {{ item.book.author }}</div>
                    <div class="book-card-meta">
                        <span class="book-status draft">Draft</span>
                        <a
                            href="/admin/books/book/{{ item.book.pk }}/change/"
                            class="edit-link"
                            >Edit Book ‚Üí</a
                        >
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    {% if failed_uploads %}
    <div class="results-section">
        <h2 class="section-title">‚úó Failed Uploads ({{ failed_count }})</h2>
        <div class="failures-list">
            {% for failure in failed_uploads %}
            <div class="failure-item">
                <span class="failure-icon">‚ö†Ô∏è</span>
                <div class="failure-details">
                    <div class="failure-filename">{{ failure.filename }}</div>
                    <div class="failure-error">{{ failure.error }}</div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% else %}
    <div class="results-section">
        <h2 class="section-title">‚úó Failed Uploads</h2>
        <div class="no-failures">
            <p>None.</p>
        </div>
    </div>
    {% endif %}

    <div class="actions-bar">
        <a href="{% url 'books:batch-upload' %}" class="btn btn-success"
            >Upload Another Batch</a
        >
        <a href="{% url 'books:book-list' %}" class="back-link"
            >Back to Book List</a
        >
    </div>
</div>
{% endblock content %}
